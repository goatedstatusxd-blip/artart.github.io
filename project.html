<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Project</title>
  <link rel="stylesheet" href="css/project.css">
</head>
<body>

<!-- Back button -->
<a href="index.html" class="back-btn">← Back</a>

<div class="project-wrapper" id="project"></div>

<!-- Lightbox -->
<div class="lightbox" id="lightbox">
  <button class="lightbox-btn left" id="prev">‹</button>
  <img id="lightbox-img" src="">
  <button class="lightbox-btn right" id="next">›</button>
  <span class="lightbox-close" id="close">×</span>
</div>


<script src="js/projects.js"></script>
<script>
const params = new URLSearchParams(window.location.search);
const id = Number(params.get("id"));
const project = projects.find(p => p.id === id);

if (!project) {
  document.body.innerHTML = "<p>Project not found</p>";
  throw new Error("Invalid project ID");
}

const galleryItems = project.gallery || [];
let currentIndex = 0;

document.getElementById("project").innerHTML = `
  <div class="project-top">
    <div class="project-main">
      <img src="${project.link}" alt="${project.title}">
    </div>

    <div class="project-info">
      <h1>${project.title.toUpperCase()}</h1>
      <p>${project.description || ""}</p>
    </div>
  </div>

  <div class="project-gallery">
    ${galleryItems.map((item, i) => `
      <img src="${item.link}" data-index="${i}">
    `).join("")}
  </div>
`;

/* Lightbox logic */
const lightbox = document.getElementById("lightbox");
const lightboxImg = document.getElementById("lightbox-img");

document.querySelectorAll(".project-gallery img").forEach(img => {
  img.addEventListener("click", () => {
    currentIndex = Number(img.dataset.index);
    openLightbox();
  });
});

function openLightbox() {
  lightboxImg.src = galleryItems[currentIndex].link;
  lightbox.classList.add("active");
}

function closeLightbox() {
  lightbox.classList.remove("active");
}

function nextImage() {
  currentIndex = (currentIndex + 1) % galleryItems.length;
  lightboxImg.src = galleryItems[currentIndex].link;
}

function prevImage() {
  currentIndex = (currentIndex - 1 + galleryItems.length) % galleryItems.length;
  lightboxImg.src = galleryItems[currentIndex].link;
}

document.getElementById("close").onclick = closeLightbox;
document.getElementById("next").onclick = nextImage;
document.getElementById("prev").onclick = prevImage;

lightbox.addEventListener("click", e => {
  if (e.target === lightbox) closeLightbox();
});
</script>

</body>
</html>
