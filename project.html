<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Project</title>
  <link rel="stylesheet" href="css/project.css">
</head>
<body>

<a class="back-btn" href="index.html">‚Üê Back</a>

<div class="project-container"></div>

<!-- Lightbox -->
<div class="lightbox" id="lightbox">
  <span class="close">&times;</span>
  <span class="prev">&#10094;</span>
  <img class="lightbox-img">
  <span class="next">&#10095;</span>
</div>

<script src="js/projects.js"></script>
<script>
const params = new URLSearchParams(window.location.search);
const title = params.get("project");
const project = projects.find(p => p.title === title);

const container = document.querySelector(".project-container");

if (!project) {
  container.innerHTML = "<p>Project not found</p>";
  throw new Error("Project not found");
}

/* MAIN MEDIA */
const mainMedia = project.type === "video"
  ? `<iframe src="${project.link}" allowfullscreen></iframe>`
  : `<img src="${project.link}">`;

container.innerHTML = `
  <div class="main-project">
    <div class="main-media">${mainMedia}</div>
    <div class="project-info">
      <h1>${project.title.toUpperCase()}</h1>
      <p>${project.description}</p>
    </div>
  </div>

  <div class="project-gallery">
    ${project.gallery.map((img, i) =>
      `<img src="${img}" data-index="${i}">`
    ).join("")}
  </div>
`;

/* LIGHTBOX */
const lightbox = document.getElementById("lightbox");
const lightboxImg = document.querySelector(".lightbox-img");
const galleryImgs = document.querySelectorAll(".project-gallery img");
let current = 0;

function openLightbox(index) {
  current = index;
  lightbox.style.display = "flex";
  lightboxImg.src = project.gallery[current];
}

function closeLightbox() {
  lightbox.style.display = "none";
}

function next() {
  current = (current + 1) % project.gallery.length;
  lightboxImg.src = project.gallery[current];
}

function prev() {
  current = (current - 1 + project.gallery.length) % project.gallery.length;
  lightboxImg.src = project.gallery[current];
}

galleryImgs.forEach(img =>
  img.addEventListener("click", () => openLightbox(img.dataset.index))
);

document.querySelector(".close").onclick = closeLightbox;
document.querySelector(".next").onclick = next;
document.querySelector(".prev").onclick = prev;

lightbox.onclick = e => {
  if (e.target === lightbox) closeLightbox();
};
</script>
</body>
</html>
